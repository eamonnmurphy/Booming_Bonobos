require(ggplot2)
# Load the dataset
rm(list =ls())
setwd("Booming_Bonobos/Week3/code/")
load("../data/KeyWestAnnualMeanTemperature.RData")
View(ats)
N <- ats[1:99, 2]
N
length(N)
N_1 <- ats[2:100, 2]
N_1
ObsCor <- cor(N, N_1, method = c("spearman"))
dist <- ggplot(data = ats, aes(x = Temp, y= Year)) +
geom_point()
dist
dist <- ggplot(data = ats, aes(x = Year, y= Temp)) +
geom_point()
dist
dist <- ggplot(data = ats, aes(x = Year, y= Temp)) +
geom_point()+
xlab("Year") +
ylab("Annual temperature in degrees")+
ggtitle("Annual temperature in Florida USA for the 20th century") +
theme_bw()
dist
dist <- ggplot(data = ats, aes(x = Year, y= Temp)) +
geom_point()+
scale_x_continuous(breaks = seq(1900,2000, by = 10))
dist <- ggplot(data = ats, aes(x = Year, y= Temp)) +
geom_point()+
scale_x_continuous(breaks = seq(1900,2000, by = 10))+
xlab("Year") +
ylab("Annual temperature in degrees")+
ggtitle("Annual temperature in Florida USA for the 20th century") +
theme_bw()
dist
#The number of observations in the given sample
n <- length(N)
P <- 100000
#The number of observations in the given sample
n <- length(ats$Year)
variable <- ats$Year
MatrixSamp <- matrix(0, nrow = n, ncol = P)
#Create a permutation sample and store in each column of the matrix
for (i in 1:P){
MatrixSamp[,i] <- sample(variable, size = n, replace=FALSE)
}
CorCoeff.test <- rep(0, P)
for (i in 1:P){
CorCoeff.test[i] <- cor(MatrixSamp[1:99,i], MatrixSamp[2:100,i],method = c("spearman"))
}
P_value <- mean(CorCoeff.test >= CorCoeff)
P_value <- mean(CorCoeff.test >= ObsCor)
data <- as.data.frame(CorCoeff.test)
Florida <- ggplot(ats, aes(x = Year, y = Temp))+
geom_point() +
scale_x_continuous(breaks = seq(1900,2000, by = 10))+
ylab("Temperature")+
ggtitle("Temperature in Florida from 1901 to 2000") +
theme_bw()
#Plot the density graph of the permutation tests
CorPlot <- ggplot(data, aes(x=CorCoeff.test))+
geom_density(stat = "density",
position = "identity") +
xlim(-0.6, 0.6)+
geom_vline(xintercept = CorCoeff, #Illustrate the observed Correlation coefficient
colour = "red",
linetype = "dashed")+
annotate(geom = "text", x = 0.38, y = 3,size = 2,
label = "Observed cor = 0.53") +
xlab("Permutation test of correlation coefficient between Florida temp/year ") +
ylab("Frequency") +
theme_bw()+
theme(aspect.ratio = 1)
#Plot the density graph of the permutation tests
CorPlot <- ggplot(data, aes(x=CorCoeff.test))+
geom_density(stat = "density",
position = "identity") +
xlim(-0.6, 0.6)+
geom_vline(xintercept = ObsCor, #Illustrate the observed Correlation coefficient
colour = "red",
linetype = "dashed")+
annotate(geom = "text", x = 0.38, y = 3,size = 2,
label = "Observed cor = 0.53") +
xlab("Permutation test of correlation coefficient between Florida temp/year ") +
ylab("Frequency") +
theme_bw()+
theme(aspect.ratio = 1)
CorPlot
P_value
#Plot the density graph of the permutation tests
CorPlot <- ggplot(data, aes(x=CorCoeff.test))+
geom_density(stat = "density",
position = "identity") +
xlim(-0.6, 0.6)+
geom_vline(xintercept = ObsCor, #Illustrate the observed Correlation coefficient
colour = "red",
linetype = "dashed")+
annotate(geom = "text", x = 0.3, y = 3,
label = "Observed cor = 0.341") +
xlab("Permutation test of correlation coefficient between Florida temp/year ") +
ylab("Frequency") +
theme_bw()+
theme(aspect.ratio = 1)
CorPlot
#Plot the density graph of the permutation tests
CorPlot <- ggplot(data, aes(x=CorCoeff.test))+
geom_density(stat = "density",
position = "identity") +
xlim(-0.6, 0.6)+
geom_vline(xintercept = ObsCor, #Illustrate the observed Correlation coefficient
colour = "red",
linetype = "dashed")+
annotate(geom = "text", x = 0.2, y = 3,
label = "Observed cor = 0.341") +
xlab("Permutation test of correlation coefficient between Florida temp/year ") +
ylab("Frequency") +
theme_bw()+
theme(aspect.ratio = 1)
CorPlot
#Plot the density graph of the permutation tests
CorPlot <- ggplot(data, aes(x=CorCoeff.test))+
geom_density(stat = "density",
position = "identity") +
xlim(-0.6, 0.6)+
geom_vline(xintercept = ObsCor, #Illustrate the observed Correlation coefficient
colour = "red",
linetype = "dashed")+
annotate(geom = "text", x = 0.2, y = 3,
label = "Observed cor = 0.341 \n P-value = 0.00026") +
xlab("Permutation test of correlation coefficient between Florida temp/year ") +
ylab("Frequency") +
theme_bw()+
theme(aspect.ratio = 1)
CorPlot
#Plot the density graph of the permutation tests
CorPlot <- ggplot(data, aes(x=CorCoeff.test))+
geom_density(stat = "density",
position = "identity") +
xlim(-0.6, 0.6)+
geom_vline(xintercept = ObsCor, #Illustrate the observed Correlation coefficient
colour = "red",
linetype = "dashed")+
annotate(geom = "text", x = 0.24, y = 3,
label = "Observed cor = 0.341 \n P-value = 0.00026") +
xlab("Permutation test of correlation coefficient between Florida temp/year ") +
ylab("Frequency") +
theme_bw()+
theme(aspect.ratio = 1)
CorPlot
#Plot the density graph of the permutation tests
CorPlot <- ggplot(data, aes(x=CorCoeff.test))+
geom_density(stat = "density",
position = "identity") +
xlim(-0.6, 0.6)+
geom_vline(xintercept = ObsCor, #Illustrate the observed Correlation coefficient
colour = "red",
linetype = "dashed")+
annotate(geom = "text", x = 0.22, y = 3,
label = "Observed cor = 0.341 \n P-value = 0.00026") +
xlab("Permutation test of correlation coefficient between Florida temp/year ") +
ylab("Frequency") +
theme_bw()+
theme(aspect.ratio = 1)
CorPlot
#Plot the density graph of the permutation tests
CorPlot <- ggplot(data, aes(x=CorCoeff.test))+
geom_density(stat = "density",
position = "identity") +
xlim(-0.6, 0.6)+
geom_vline(xintercept = ObsCor, #Illustrate the observed Correlation coefficient
colour = "red",
linetype = "dashed")+
annotate(geom = "text", x = 0.22, y = 3,
label = "Observed cor = 0.341 \n P-value = 0.00026") +
xlab("Permutation test of correlation coefficient for successive years ") +
ylab("Frequency") +
theme_bw()+
theme(aspect.ratio = 1)
CorPlot
#Plot the density graph of the permutation tests
CorPlot <- ggplot(data, aes(x=CorCoeff.test))+
geom_density(stat = "density",
position = "identity") +
xlim(-0.6, 0.6)+
geom_vline(xintercept = ObsCor, #Illustrate the observed Correlation coefficient
colour = "red",
linetype = "dashed")+
annotate(geom = "text", x = 0.22, y = 3,
label = "Observed cor = 0.341 \n P-value = 0.00026") +
xlab("Correlation coefficient for successive years ") +
ylab("Frequency") +
ggtitle("Permutation tests for autocorrelation between successive years ")
#Plot the density graph of the permutation tests
CorPlot <- ggplot(data, aes(x=CorCoeff.test))+
geom_density(stat = "density",
position = "identity") +
xlim(-0.6, 0.6)+
geom_vline(xintercept = ObsCor, #Illustrate the observed Correlation coefficient
colour = "red",
linetype = "dashed")+
annotate(geom = "text", x = 0.22, y = 3,
label = "Observed cor = 0.341 \n P-value = 0.00026") +
xlab("Correlation coefficient for successive years ") +
ylab("Frequency") +
ggtitle("Permutation tests for autocorrelation between successive years ") +
theme_bw()+
theme(aspect.ratio = 1)
CorPlot
paste("The correlation coefficient between the successive years is", ObsCor, "with the estimated P-value of", P_value)
paste("The correlation coefficient between the successive years is", round(ObsCor, digits = 4), "with the estimated P-value of", P_value)
paste("The correlation coefficient between the successive years is", round(ObsCor, digits = 3), "with the estimated P-value of", P_value)
set.seed(1)
N <- ats[1:99, 2]
# Load the dataset
rm(list =ls())
load("../data/KeyWestAnnualMeanTemperature.RData")
set.seed(1)
N <- ats[1:99, 2]
N_1 <- ats[2:100, 2] #select the successive years
ObsCor <- cor(N, N_1, method = c("spearman"))
#The number of observations in the given sample
n <- length(ats$Year)
P <- 100000
variable <- ats$Year
MatrixSamp <- matrix(0, nrow = n, ncol = P)
#Create a permutation sample and store in each column of the matrix
for (i in 1:P){
MatrixSamp[,i] <- sample(variable, size = n, replace=FALSE)
}
CorCoeff.test <- rep(0, P)
for (i in 1:P){
CorCoeff.test[i] <- cor(MatrixSamp[1:99,i], MatrixSamp[2:100,i],method = c("spearman"))
}
P_value <- mean(CorCoeff.test >= ObsCor)
paste("The correlation coefficient between the successive years is", round(ObsCor, digits = 3), "with the estimated P-value of", P_value)
data <- as.data.frame(CorCoeff.test)
Florida <- ggplot(ats, aes(x = Year, y = Temp))+
geom_point() +
scale_x_continuous(breaks = seq(1900,2000, by = 10))+
ylab("Temperature")+
ggtitle("Temperature in Florida from 1901 to 2000") +
theme_bw()
#Plot the density graph of the permutation tests
CorPlot <- ggplot(data, aes(x=CorCoeff.test))+
geom_density(stat = "density",
position = "identity") +
xlim(-0.6, 0.6)+
geom_vline(xintercept = ObsCor, #Illustrate the observed Correlation coefficient
colour = "red",
linetype = "dashed")+
annotate(geom = "text", x = 0.22, y = 3,
label = "Observed cor = 0.341 \n P-value = 0.00015") +
xlab("Correlation coefficient for successive years ") +
ylab("Frequency") +
ggtitle("Permutation tests for autocorrelation between successive years ") +
theme_bw()+
theme(aspect.ratio = 1)
CorPlot
ggsave("../results/DistributionFlorida.pdf", plot = Florida ,
width = 14.8, height = 10.5, units = "cm")
ggsave("../results/PermuCorCoeff_TAutoCorr.pdf", plot = CorPlot ,
width = 29.7, height = 21, units = "cm")
